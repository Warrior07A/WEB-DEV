generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model bookings {
  id             String    @id @db.VarChar(255)     @default(uuid())
  user_id        String   @db.VarChar(255)
  room_id        String   @db.VarChar(255)
  hotel_id       String   @db.VarChar(255)
  check_in_date  DateTime  @db.Date
  check_out_date DateTime  @db.Date
  guests         Int
  total_price    Decimal   @db.Decimal(10, 2)
  status         String?   @default("confirmed") @db.VarChar(50)
  booking_date   DateTime? @default(now()) @db.Timestamp(6)
  cancelled_at   DateTime? @db.Timestamp(6)
  hotels         hotels?   @relation(fields: [hotel_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  rooms          rooms?    @relation(fields: [room_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  users          users?    @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  reviews        reviews[]
}

model hotels {
  id            String     @id @db.VarChar(255)       @default(uuid())
  owner_id      String    @db.VarChar(255)
  name          String     @db.VarChar(255)
  description   String?
  city          String     @db.VarChar(100)
  country       String     @db.VarChar(100)
  amenities     Json?      @default("[]")
  rating        Decimal?   @default(0.0) @db.Decimal(2, 1)
  total_reviews Int?       @default(0)
  created_at    DateTime?  @default(now()) @db.Timestamp(6)
  bookings      bookings[]
  users         users?     @relation(fields: [owner_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  reviews       reviews[]
  rooms         rooms[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model reviews {
  id         String    @id @db.VarChar(255)  @default(uuid())
  user_id    String?   @db.VarChar(255)
  hotel_id   String?   @db.VarChar(255)
  booking_id String?   @db.VarChar(255)
  rating     Int
  comment    String?
  created_at DateTime? @default(now()) @db.Timestamp(6)
  bookings   bookings? @relation(fields: [booking_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hotels     hotels?   @relation(fields: [hotel_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  users      users?    @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([user_id, booking_id])
}

model rooms {
  id              String     @id @db.VarChar(255)  @default(uuid())
  hotel_id        String   @db.VarChar(255)
  room_number     String     @db.VarChar(50)
  room_type       String     @db.VarChar(100)
  price_per_night Decimal    @db.Decimal(10, 2)
  max_occupancy   Int
  created_at      DateTime?  @default(now()) @db.Timestamp(6)
  bookings        bookings[]
  hotels          hotels?    @relation(fields: [hotel_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([hotel_id, room_number])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model users {
  id         String     @id @db.VarChar(255) @default(uuid())
  name       String     @db.VarChar(255)
  email      String     @unique @db.VarChar(255)
  password   String     @db.VarChar(255)
  role        ROLE      @default(customer)
  phone      String?    @db.VarChar(20)
  created_at DateTime?  @default(now()) @db.Timestamp(6)
  bookings   bookings[]
  hotels     hotels[]
  reviews    reviews[]
}


enum ROLE{
    customer
    owner
}
enum PRIORITY {
  LOW
  MEDIUM
  HIGH
}

enum STATUS {
  TODO
  IN_PROGRESS
  DONE
}
